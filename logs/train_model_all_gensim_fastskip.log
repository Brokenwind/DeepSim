nohup: ignoring input
/usr/local/lib/python3.5/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
INFO:starting loading embedding
DEBUG:{'mode': 'rb', 'uri': '../model/char2vec_fastskip256.bin', 'kw': {}}
INFO:loading 11474 words for fastText model from ../model/char2vec_fastskip256.bin
INFO:resetting layer weights
INFO:Total number of ngrams is 0
INFO:Updating model with new vocabulary
INFO:New added 11474 unique words (50% of original 22948) and increased the count of 11474 pre-existing words (50% of original 22948)
INFO:deleting the raw counts dictionary of 11474 items
INFO:sample=0.0001 downsamples 1636 most-common words
INFO:downsampling leaves estimated 353425077 word corpus (102.2% of prior 345851916)
INFO:loaded (2011474, 256) weight matrix for fastText model from ../model/char2vec_fastskip256.bin
DEBUG:{'mode': 'rb', 'uri': '../model/word2vec_fastskip256.bin', 'kw': {}}
INFO:loading 482750 words for fastText model from ../model/word2vec_fastskip256.bin
INFO:resetting layer weights
INFO:Total number of ngrams is 0
INFO:Updating model with new vocabulary
INFO:New added 482750 unique words (50% of original 965500) and increased the count of 482750 pre-existing words (50% of original 965500)
INFO:deleting the raw counts dictionary of 482750 items
INFO:sample=0.0001 downsamples 710 most-common words
INFO:downsampling leaves estimated 272504639 word corpus (147.3% of prior 185032399)
INFO:loaded (2482750, 256) weight matrix for fastText model from ../model/word2vec_fastskip256.bin
INFO:end loading embedding
2019-03-05 05:51:16.561669: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-05 05:51:16.697829: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-03-05 05:51:16.698353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:00:04.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-05 05:51:16.698394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-05 05:51:17.011890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-05 05:51:17.011969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-05 05:51:17.011983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-05 05:51:17.012374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10742 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
start 1 model train
=======   CONFIG:  ('siamese', 'char', 24, 'fastskip', 256, [100, 80, 64, 64], 97, 8)
=======   CONFIG:  ('siamese', 'char', 24, 'fastskip', 256, [100, 80, 64, 64], 97, 8)
total iters per cycle(epoch): 1562
Train on 99915 samples, validate on 2562 samples
Epoch 1/97
 - 244s - loss: 19.4874 - binary_crossentropy: 0.6637 - acc: 0.8119 - val_loss: 0.9178 - val_binary_crossentropy: 0.5900 - val_acc: 0.8119
Epoch 2/97
 - 239s - loss: 1.7593 - binary_crossentropy: 0.6399 - acc: 0.8146 - val_loss: 0.7680 - val_binary_crossentropy: 0.5600 - val_acc: 0.8134
Epoch 3/97
 - 238s - loss: 1.6525 - binary_crossentropy: 0.6181 - acc: 0.8164 - val_loss: 0.7857 - val_binary_crossentropy: 0.5651 - val_acc: 0.8146
Epoch 4/97
 - 239s - loss: 1.6369 - binary_crossentropy: 0.6083 - acc: 0.8165 - val_loss: 0.7372 - val_binary_crossentropy: 0.5349 - val_acc: 0.8193
Epoch 5/97
 - 239s - loss: 1.5862 - binary_crossentropy: 0.5949 - acc: 0.8173 - val_loss: 0.7553 - val_binary_crossentropy: 0.5595 - val_acc: 0.8154
Epoch 6/97
 - 239s - loss: 1.5256 - binary_crossentropy: 0.5858 - acc: 0.8176 - val_loss: 0.7145 - val_binary_crossentropy: 0.5453 - val_acc: 0.8169
Epoch 7/97
 - 239s - loss: 1.4903 - binary_crossentropy: 0.5770 - acc: 0.8176 - val_loss: 0.6986 - val_binary_crossentropy: 0.5284 - val_acc: 0.8189
Epoch 8/97
 - 239s - loss: 1.4678 - binary_crossentropy: 0.5700 - acc: 0.8175 - val_loss: 0.6838 - val_binary_crossentropy: 0.5335 - val_acc: 0.8185
Epoch 9/97
 - 238s - loss: 1.4479 - binary_crossentropy: 0.5632 - acc: 0.8178 - val_loss: 0.6902 - val_binary_crossentropy: 0.5378 - val_acc: 0.8177
Epoch 10/97
 - 239s - loss: 1.4229 - binary_crossentropy: 0.5596 - acc: 0.8180 - val_loss: 0.7061 - val_binary_crossentropy: 0.5606 - val_acc: 0.8165
Epoch 11/97
 - 238s - loss: 1.4226 - binary_crossentropy: 0.5559 - acc: 0.8177 - val_loss: 0.6960 - val_binary_crossentropy: 0.5493 - val_acc: 0.8177
Epoch 12/97
 - 239s - loss: 1.3991 - binary_crossentropy: 0.5515 - acc: 0.8179 - val_loss: 0.6707 - val_binary_crossentropy: 0.5339 - val_acc: 0.8181
Epoch 13/97
 - 237s - loss: 1.3938 - binary_crossentropy: 0.5489 - acc: 0.8178 - val_loss: 0.6460 - val_binary_crossentropy: 0.5082 - val_acc: 0.8177
Epoch 14/97
 - 238s - loss: 1.3747 - binary_crossentropy: 0.5449 - acc: 0.8181 - val_loss: 0.6518 - val_binary_crossentropy: 0.5173 - val_acc: 0.8189
Epoch 15/97
 - 237s - loss: 1.3754 - binary_crossentropy: 0.5439 - acc: 0.8181 - val_loss: 0.6687 - val_binary_crossentropy: 0.5384 - val_acc: 0.8169
Epoch 16/97
 - 238s - loss: 1.3646 - binary_crossentropy: 0.5425 - acc: 0.8182 - val_loss: 0.6628 - val_binary_crossentropy: 0.5311 - val_acc: 0.8177
Epoch 17/97
 - 238s - loss: 1.3609 - binary_crossentropy: 0.5399 - acc: 0.8183 - val_loss: 0.6692 - val_binary_crossentropy: 0.5411 - val_acc: 0.8177
Epoch 18/97
 - 237s - loss: 1.3544 - binary_crossentropy: 0.5386 - acc: 0.8181 - val_loss: 0.6767 - val_binary_crossentropy: 0.5467 - val_acc: 0.8181
Epoch 19/97
 - 238s - loss: 1.3482 - binary_crossentropy: 0.5372 - acc: 0.8185 - val_loss: 0.6610 - val_binary_crossentropy: 0.5345 - val_acc: 0.8181
Epoch 20/97
 - 238s - loss: 1.3456 - binary_crossentropy: 0.5351 - acc: 0.8184 - val_loss: 0.6656 - val_binary_crossentropy: 0.5389 - val_acc: 0.8173
Epoch 21/97
 - 237s - loss: 1.3495 - binary_crossentropy: 0.5339 - acc: 0.8184 - val_loss: 0.6510 - val_binary_crossentropy: 0.5258 - val_acc: 0.8169
2019-03-05 07:15:05.386980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-05 07:15:05.387051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-05 07:15:05.387063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-05 07:15:05.387071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-05 07:15:05.387226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10742 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
2019-03-05 07:15:05.730087: W tensorflow/core/framework/allocator.cc:122] Allocation of 494336000 exceeds 10% of system memory.
2019-03-05 07:15:06.131903: W tensorflow/core/framework/allocator.cc:122] Allocation of 494336000 exceeds 10% of system memory.
2019-03-05 07:15:09.267979: W tensorflow/core/framework/allocator.cc:122] Allocation of 494336000 exceeds 10% of system memory.
2019-03-05 07:15:09.673310: W tensorflow/core/framework/allocator.cc:122] Allocation of 494336000 exceeds 10% of system memory.
2019-03-05 07:15:17.984433: W tensorflow/core/framework/allocator.cc:122] Allocation of 494336000 exceeds 10% of system memory.
start 2 model train
=======   CONFIG:  ('siamese', 'word', 20, 'fastskip', 256, [100, 80, 64, 64], 116, 8)
=======   CONFIG:  ('siamese', 'word', 20, 'fastskip', 256, [100, 80, 64, 64], 116, 8)
total iters per cycle(epoch): 1562
Train on 99915 samples, validate on 2562 samples
Epoch 1/116
 - 363s - loss: 19.4737 - binary_crossentropy: 0.6685 - acc: 0.8121 - val_loss: 0.8613 - val_binary_crossentropy: 0.5416 - val_acc: 0.8134
Epoch 2/116
 - 360s - loss: 1.8627 - binary_crossentropy: 0.6602 - acc: 0.8129 - val_loss: 0.8261 - val_binary_crossentropy: 0.5727 - val_acc: 0.8060
Epoch 3/116
 - 360s - loss: 1.7596 - binary_crossentropy: 0.6501 - acc: 0.8132 - val_loss: 0.7979 - val_binary_crossentropy: 0.5512 - val_acc: 0.8126
Epoch 4/116
 - 360s - loss: 1.7334 - binary_crossentropy: 0.6435 - acc: 0.8129 - val_loss: 0.8178 - val_binary_crossentropy: 0.5928 - val_acc: 0.8119
Epoch 5/116
 - 360s - loss: 1.6837 - binary_crossentropy: 0.6352 - acc: 0.8140 - val_loss: 0.8065 - val_binary_crossentropy: 0.5959 - val_acc: 0.8126
Epoch 6/116
 - 360s - loss: 1.6628 - binary_crossentropy: 0.6316 - acc: 0.8141 - val_loss: 0.7653 - val_binary_crossentropy: 0.5763 - val_acc: 0.8103
Epoch 7/116
 - 360s - loss: 1.6110 - binary_crossentropy: 0.6129 - acc: 0.8154 - val_loss: 0.7713 - val_binary_crossentropy: 0.5636 - val_acc: 0.8146
Epoch 8/116
 - 360s - loss: 1.6024 - binary_crossentropy: 0.5999 - acc: 0.8165 - val_loss: 0.7428 - val_binary_crossentropy: 0.5550 - val_acc: 0.8185
Epoch 9/116
 - 360s - loss: 1.5648 - binary_crossentropy: 0.5942 - acc: 0.8169 - val_loss: 0.7384 - val_binary_crossentropy: 0.5644 - val_acc: 0.8154
Epoch 10/116
 - 360s - loss: 1.5485 - binary_crossentropy: 0.5894 - acc: 0.8167 - val_loss: 0.7185 - val_binary_crossentropy: 0.5519 - val_acc: 0.8165
Epoch 11/116
 - 360s - loss: 1.5185 - binary_crossentropy: 0.5822 - acc: 0.8169 - val_loss: 0.6986 - val_binary_crossentropy: 0.5305 - val_acc: 0.8189
Epoch 12/116
 - 361s - loss: 1.4983 - binary_crossentropy: 0.5757 - acc: 0.8175 - val_loss: 0.7232 - val_binary_crossentropy: 0.5610 - val_acc: 0.8169
Epoch 13/116
 - 361s - loss: 1.4864 - binary_crossentropy: 0.5728 - acc: 0.8167 - val_loss: 0.7256 - val_binary_crossentropy: 0.5773 - val_acc: 0.8177
Epoch 14/116
 - 361s - loss: 1.4676 - binary_crossentropy: 0.5667 - acc: 0.8174 - val_loss: 0.7056 - val_binary_crossentropy: 0.5529 - val_acc: 0.8185
Epoch 15/116
 - 361s - loss: 1.4582 - binary_crossentropy: 0.5617 - acc: 0.8174 - val_loss: 0.7234 - val_binary_crossentropy: 0.5631 - val_acc: 0.8162
Epoch 16/116
 - 360s - loss: 1.4474 - binary_crossentropy: 0.5576 - acc: 0.8176 - val_loss: 0.7182 - val_binary_crossentropy: 0.5716 - val_acc: 0.8165
Epoch 17/116
 - 360s - loss: 1.4340 - binary_crossentropy: 0.5512 - acc: 0.8178 - val_loss: 0.7073 - val_binary_crossentropy: 0.5560 - val_acc: 0.8173
Epoch 18/116
 - 361s - loss: 1.4368 - binary_crossentropy: 0.5483 - acc: 0.8182 - val_loss: 0.7071 - val_binary_crossentropy: 0.5602 - val_acc: 0.8150
Epoch 19/116
 - 361s - loss: 1.4133 - binary_crossentropy: 0.5425 - acc: 0.8183 - val_loss: 0.6871 - val_binary_crossentropy: 0.5405 - val_acc: 0.8162
Epoch 20/116
 - 361s - loss: 1.3996 - binary_crossentropy: 0.5385 - acc: 0.8183 - val_loss: 0.6907 - val_binary_crossentropy: 0.5470 - val_acc: 0.8162
Epoch 21/116
 - 361s - loss: 1.3943 - binary_crossentropy: 0.5365 - acc: 0.8184 - val_loss: 0.6932 - val_binary_crossentropy: 0.5526 - val_acc: 0.8177
Epoch 22/116
 - 360s - loss: 1.3845 - binary_crossentropy: 0.5322 - acc: 0.8183 - val_loss: 0.7005 - val_binary_crossentropy: 0.5592 - val_acc: 0.8165
Epoch 23/116
 - 360s - loss: 1.3835 - binary_crossentropy: 0.5308 - acc: 0.8184 - val_loss: 0.6802 - val_binary_crossentropy: 0.5378 - val_acc: 0.8162
Epoch 24/116
 - 361s - loss: 1.3699 - binary_crossentropy: 0.5267 - acc: 0.8184 - val_loss: 0.6832 - val_binary_crossentropy: 0.5410 - val_acc: 0.8177
Epoch 25/116
 - 360s - loss: 1.3652 - binary_crossentropy: 0.5257 - acc: 0.8186 - val_loss: 0.6747 - val_binary_crossentropy: 0.5371 - val_acc: 0.8162
Epoch 26/116
 - 360s - loss: 1.3563 - binary_crossentropy: 0.5214 - acc: 0.8187 - val_loss: 0.6956 - val_binary_crossentropy: 0.5606 - val_acc: 0.8162
Epoch 27/116
 - 361s - loss: 1.3555 - binary_crossentropy: 0.5211 - acc: 0.8187 - val_loss: 0.6834 - val_binary_crossentropy: 0.5460 - val_acc: 0.8181
Epoch 28/116
 - 360s - loss: 1.3442 - binary_crossentropy: 0.5177 - acc: 0.8190 - val_loss: 0.6724 - val_binary_crossentropy: 0.5363 - val_acc: 0.8185
Epoch 29/116
 - 360s - loss: 1.3419 - binary_crossentropy: 0.5169 - acc: 0.8189 - val_loss: 0.6574 - val_binary_crossentropy: 0.5226 - val_acc: 0.8154
Epoch 30/116
 - 360s - loss: 1.3355 - binary_crossentropy: 0.5142 - acc: 0.8188 - val_loss: 0.6957 - val_binary_crossentropy: 0.5610 - val_acc: 0.8173
Epoch 31/116
 - 360s - loss: 1.3330 - binary_crossentropy: 0.5125 - acc: 0.8191 - val_loss: 0.6815 - val_binary_crossentropy: 0.5472 - val_acc: 0.8173
Epoch 32/116
 - 360s - loss: 1.3285 - binary_crossentropy: 0.5109 - acc: 0.8191 - val_loss: 0.6914 - val_binary_crossentropy: 0.5563 - val_acc: 0.8169
Epoch 33/116
 - 359s - loss: 1.3237 - binary_crossentropy: 0.5086 - acc: 0.8192 - val_loss: 0.7102 - val_binary_crossentropy: 0.5762 - val_acc: 0.8158
Epoch 34/116
 - 360s - loss: 1.3172 - binary_crossentropy: 0.5068 - acc: 0.8191 - val_loss: 0.6878 - val_binary_crossentropy: 0.5572 - val_acc: 0.8165
Epoch 35/116
 - 360s - loss: 1.3154 - binary_crossentropy: 0.5064 - acc: 0.8193 - val_loss: 0.6998 - val_binary_crossentropy: 0.5689 - val_acc: 0.8169
Epoch 36/116
 - 360s - loss: 1.3113 - binary_crossentropy: 0.5045 - acc: 0.8195 - val_loss: 0.6796 - val_binary_crossentropy: 0.5519 - val_acc: 0.8169
Epoch 37/116
 - 360s - loss: 1.3064 - binary_crossentropy: 0.5026 - acc: 0.8195 - val_loss: 0.6742 - val_binary_crossentropy: 0.5441 - val_acc: 0.8181
2019-03-05 10:59:19.560028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-05 10:59:19.647570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-05 10:59:19.647617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-05 10:59:19.647628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-05 10:59:19.711606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10742 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
start 3 model train
=======   CONFIG:  ('esim', 'char', 24, 'fastskip', 256, [], 18, 8)
=======   CONFIG:  ('esim', 'char', 24, 'fastskip', 256, [], 18, 8)
total iters per cycle(epoch): 1562
Train on 99915 samples, validate on 2562 samples
Epoch 1/18
 - 250s - loss: 1.2591 - binary_crossentropy: 0.6110 - acc: 0.7898 - val_loss: 0.5308 - val_binary_crossentropy: 0.5308 - val_acc: 0.8162
Epoch 2/18
 - 245s - loss: 0.8097 - binary_crossentropy: 0.5126 - acc: 0.8188 - val_loss: 0.4488 - val_binary_crossentropy: 0.4488 - val_acc: 0.8169
Epoch 3/18
 - 247s - loss: 0.7364 - binary_crossentropy: 0.4635 - acc: 0.8205 - val_loss: 0.4353 - val_binary_crossentropy: 0.4353 - val_acc: 0.8165
Epoch 4/18
 - 246s - loss: 0.6877 - binary_crossentropy: 0.4302 - acc: 0.8246 - val_loss: 0.4183 - val_binary_crossentropy: 0.4183 - val_acc: 0.8236
Epoch 5/18
 - 243s - loss: 0.6504 - binary_crossentropy: 0.4033 - acc: 0.8293 - val_loss: 0.4442 - val_binary_crossentropy: 0.4442 - val_acc: 0.8251
Epoch 6/18
 - 243s - loss: 0.6100 - binary_crossentropy: 0.3754 - acc: 0.8391 - val_loss: 0.4238 - val_binary_crossentropy: 0.4238 - val_acc: 0.8341
Epoch 7/18
 - 243s - loss: 0.5606 - binary_crossentropy: 0.3410 - acc: 0.8539 - val_loss: 0.4369 - val_binary_crossentropy: 0.4369 - val_acc: 0.8380
Epoch 8/18
 - 244s - loss: 0.5102 - binary_crossentropy: 0.3085 - acc: 0.8725 - val_loss: 0.4546 - val_binary_crossentropy: 0.4546 - val_acc: 0.8411
Epoch 9/18
 - 243s - loss: 0.4541 - binary_crossentropy: 0.2716 - acc: 0.8898 - val_loss: 0.4695 - val_binary_crossentropy: 0.4695 - val_acc: 0.8454
Epoch 10/18
 - 243s - loss: 0.3945 - binary_crossentropy: 0.2341 - acc: 0.9091 - val_loss: 0.5048 - val_binary_crossentropy: 0.5048 - val_acc: 0.8443
Epoch 11/18
 - 243s - loss: 0.3477 - binary_crossentropy: 0.2065 - acc: 0.9207 - val_loss: 0.5375 - val_binary_crossentropy: 0.5375 - val_acc: 0.8388
Epoch 12/18
 - 243s - loss: 0.3086 - binary_crossentropy: 0.1827 - acc: 0.9313 - val_loss: 0.5549 - val_binary_crossentropy: 0.5549 - val_acc: 0.8415
2019-03-05 11:48:30.473467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-05 11:48:30.473672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-05 11:48:30.473690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-05 11:48:30.473698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-05 11:48:30.473931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10742 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
start 4 model train
=======   CONFIG:  ('esim', 'word', 20, 'fastskip', 256, [], 21, 8)
=======   CONFIG:  ('esim', 'word', 20, 'fastskip', 256, [], 21, 8)
total iters per cycle(epoch): 1562
Train on 99915 samples, validate on 2562 samples
Epoch 1/21
 - 423s - loss: 1.2909 - binary_crossentropy: 0.6364 - acc: 0.7886 - val_loss: 0.5557 - val_binary_crossentropy: 0.5557 - val_acc: 0.8162
Epoch 2/21
 - 420s - loss: 0.8588 - binary_crossentropy: 0.5501 - acc: 0.8175 - val_loss: 0.5161 - val_binary_crossentropy: 0.5161 - val_acc: 0.8162
Epoch 3/21
 - 423s - loss: 0.7780 - binary_crossentropy: 0.4952 - acc: 0.8186 - val_loss: 0.4943 - val_binary_crossentropy: 0.4943 - val_acc: 0.8162
Epoch 4/21
 - 420s - loss: 0.7146 - binary_crossentropy: 0.4506 - acc: 0.8222 - val_loss: 0.5045 - val_binary_crossentropy: 0.5045 - val_acc: 0.8189
Epoch 5/21
 - 423s - loss: 0.6529 - binary_crossentropy: 0.4065 - acc: 0.8326 - val_loss: 0.4957 - val_binary_crossentropy: 0.4957 - val_acc: 0.8208
Epoch 6/21
 - 421s - loss: 0.5843 - binary_crossentropy: 0.3586 - acc: 0.8500 - val_loss: 0.5333 - val_binary_crossentropy: 0.5333 - val_acc: 0.8251
Epoch 7/21
 - 424s - loss: 0.5052 - binary_crossentropy: 0.3056 - acc: 0.8765 - val_loss: 0.5450 - val_binary_crossentropy: 0.5450 - val_acc: 0.8236
Epoch 8/21
 - 421s - loss: 0.4350 - binary_crossentropy: 0.2623 - acc: 0.8982 - val_loss: 0.5831 - val_binary_crossentropy: 0.5831 - val_acc: 0.8232
Epoch 9/21
 - 421s - loss: 0.3653 - binary_crossentropy: 0.2172 - acc: 0.9173 - val_loss: 0.6311 - val_binary_crossentropy: 0.6311 - val_acc: 0.8228
Epoch 10/21
 - 422s - loss: 0.3111 - binary_crossentropy: 0.1851 - acc: 0.9317 - val_loss: 0.6933 - val_binary_crossentropy: 0.6933 - val_acc: 0.8255
Epoch 11/21
 - 425s - loss: 0.2700 - binary_crossentropy: 0.1589 - acc: 0.9420 - val_loss: 0.7497 - val_binary_crossentropy: 0.7497 - val_acc: 0.8236
2019-03-05 13:06:44.508722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-05 13:06:44.508979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-05 13:06:44.508995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-05 13:06:44.509002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-05 13:06:44.509284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10742 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
start 5 model train
=======   CONFIG:  ('decom', 'char', 24, 'fastskip', 256, [], 85, 8)
=======   CONFIG:  ('decom', 'char', 24, 'fastskip', 256, [], 85, 8)
total iters per cycle(epoch): 1562
Train on 99915 samples, validate on 2562 samples
Epoch 1/85
 - 49s - loss: 0.9322 - binary_crossentropy: 0.5638 - acc: 0.8126 - val_loss: 0.4456 - val_binary_crossentropy: 0.4456 - val_acc: 0.8263
Epoch 2/85
 - 48s - loss: 0.7860 - binary_crossentropy: 0.5029 - acc: 0.8196 - val_loss: 0.4305 - val_binary_crossentropy: 0.4305 - val_acc: 0.8259
Epoch 3/85
 - 48s - loss: 0.7520 - binary_crossentropy: 0.4785 - acc: 0.8205 - val_loss: 0.4486 - val_binary_crossentropy: 0.4486 - val_acc: 0.8263
Epoch 4/85
 - 48s - loss: 0.7330 - binary_crossentropy: 0.4648 - acc: 0.8208 - val_loss: 0.4416 - val_binary_crossentropy: 0.4416 - val_acc: 0.8275
Epoch 5/85
 - 48s - loss: 0.7215 - binary_crossentropy: 0.4566 - acc: 0.8218 - val_loss: 0.4595 - val_binary_crossentropy: 0.4595 - val_acc: 0.8236
Epoch 6/85
 - 48s - loss: 0.7113 - binary_crossentropy: 0.4497 - acc: 0.8219 - val_loss: 0.4606 - val_binary_crossentropy: 0.4606 - val_acc: 0.8267
Epoch 7/85
 - 48s - loss: 0.7019 - binary_crossentropy: 0.4436 - acc: 0.8223 - val_loss: 0.4589 - val_binary_crossentropy: 0.4589 - val_acc: 0.8259
Epoch 8/85
 - 48s - loss: 0.6913 - binary_crossentropy: 0.4362 - acc: 0.8239 - val_loss: 0.4701 - val_binary_crossentropy: 0.4701 - val_acc: 0.8259
Epoch 9/85
 - 48s - loss: 0.6842 - binary_crossentropy: 0.4314 - acc: 0.8256 - val_loss: 0.4714 - val_binary_crossentropy: 0.4714 - val_acc: 0.8244
Epoch 10/85
 - 48s - loss: 0.6766 - binary_crossentropy: 0.4263 - acc: 0.8262 - val_loss: 0.4601 - val_binary_crossentropy: 0.4601 - val_acc: 0.8263
2019-03-05 13:14:53.735601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-05 13:14:53.735666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-05 13:14:53.735677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-05 13:14:53.735685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-05 13:14:53.735849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10742 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
start 6 model train
=======   CONFIG:  ('decom', 'word', 20, 'fastskip', 256, [], 100, 8)
=======   CONFIG:  ('decom', 'word', 20, 'fastskip', 256, [], 100, 8)
total iters per cycle(epoch): 1562
Train on 99915 samples, validate on 2562 samples
Epoch 1/100
 - 248s - loss: 0.9591 - binary_crossentropy: 0.5997 - acc: 0.8138 - val_loss: 0.4960 - val_binary_crossentropy: 0.4960 - val_acc: 0.8173
Epoch 2/100
 - 247s - loss: 0.8379 - binary_crossentropy: 0.5427 - acc: 0.8181 - val_loss: 0.5152 - val_binary_crossentropy: 0.5152 - val_acc: 0.8162
Epoch 3/100
 - 247s - loss: 0.7956 - binary_crossentropy: 0.5112 - acc: 0.8184 - val_loss: 0.4946 - val_binary_crossentropy: 0.4946 - val_acc: 0.8189
Epoch 4/100
 - 247s - loss: 0.7656 - binary_crossentropy: 0.4897 - acc: 0.8193 - val_loss: 0.5042 - val_binary_crossentropy: 0.5042 - val_acc: 0.8205
Epoch 5/100
 - 248s - loss: 0.7442 - binary_crossentropy: 0.4743 - acc: 0.8213 - val_loss: 0.5387 - val_binary_crossentropy: 0.5387 - val_acc: 0.8173
Epoch 6/100
 - 248s - loss: 0.7217 - binary_crossentropy: 0.4585 - acc: 0.8238 - val_loss: 0.5517 - val_binary_crossentropy: 0.5517 - val_acc: 0.8224
Epoch 7/100
 - 248s - loss: 0.7054 - binary_crossentropy: 0.4466 - acc: 0.8252 - val_loss: 0.5440 - val_binary_crossentropy: 0.5440 - val_acc: 0.8205
Epoch 8/100
 - 248s - loss: 0.6884 - binary_crossentropy: 0.4348 - acc: 0.8293 - val_loss: 0.5372 - val_binary_crossentropy: 0.5372 - val_acc: 0.8189
Epoch 9/100
 - 248s - loss: 0.6733 - binary_crossentropy: 0.4242 - acc: 0.8316 - val_loss: 0.5479 - val_binary_crossentropy: 0.5479 - val_acc: 0.8212
Epoch 10/100
 - 248s - loss: 0.6596 - binary_crossentropy: 0.4151 - acc: 0.8354 - val_loss: 0.5648 - val_binary_crossentropy: 0.5648 - val_acc: 0.8201
Epoch 11/100
 - 248s - loss: 0.6425 - binary_crossentropy: 0.4032 - acc: 0.8399 - val_loss: 0.5773 - val_binary_crossentropy: 0.5773 - val_acc: 0.8189
2019-03-05 14:00:58.533943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-05 14:00:58.534174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-05 14:00:58.534189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-05 14:00:58.534198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-05 14:00:58.534447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10742 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
start 7 model train
=======   CONFIG:  ('dssm', 'both', [20, 24], 'fastskip', 256, [], 116, 8)
=======   CONFIG:  ('dssm', 'both', [20, 24], 'fastskip', 256, [], 116, 8)
total iters per cycle(epoch): 1562
Train on 99915 samples, validate on 2562 samples
Epoch 1/116
 - 337s - loss: 0.8138 - binary_crossentropy: 0.5132 - acc: 0.8182 - val_loss: 0.4803 - val_binary_crossentropy: 0.4803 - val_acc: 0.8197
Epoch 2/116
 - 335s - loss: 0.7051 - binary_crossentropy: 0.4492 - acc: 0.8254 - val_loss: 0.4550 - val_binary_crossentropy: 0.4550 - val_acc: 0.8286
Epoch 3/116
 - 334s - loss: 0.6473 - binary_crossentropy: 0.4069 - acc: 0.8357 - val_loss: 0.4400 - val_binary_crossentropy: 0.4400 - val_acc: 0.8361
Epoch 4/116
 - 335s - loss: 0.5820 - binary_crossentropy: 0.3606 - acc: 0.8521 - val_loss: 0.4517 - val_binary_crossentropy: 0.4517 - val_acc: 0.8372
Epoch 5/116
 - 334s - loss: 0.5009 - binary_crossentropy: 0.3064 - acc: 0.8748 - val_loss: 0.4920 - val_binary_crossentropy: 0.4920 - val_acc: 0.8365
Epoch 6/116
 - 334s - loss: 0.4141 - binary_crossentropy: 0.2509 - acc: 0.9020 - val_loss: 0.5291 - val_binary_crossentropy: 0.5291 - val_acc: 0.8361
Epoch 7/116
 - 334s - loss: 0.3345 - binary_crossentropy: 0.2012 - acc: 0.9236 - val_loss: 0.5763 - val_binary_crossentropy: 0.5763 - val_acc: 0.8361
Epoch 8/116
 - 334s - loss: 0.2689 - binary_crossentropy: 0.1614 - acc: 0.9416 - val_loss: 0.6358 - val_binary_crossentropy: 0.6358 - val_acc: 0.8326
Epoch 9/116
 - 334s - loss: 0.2195 - binary_crossentropy: 0.1305 - acc: 0.9530 - val_loss: 0.7051 - val_binary_crossentropy: 0.7051 - val_acc: 0.8322
Epoch 10/116
 - 334s - loss: 0.1773 - binary_crossentropy: 0.1044 - acc: 0.9634 - val_loss: 0.7601 - val_binary_crossentropy: 0.7601 - val_acc: 0.8306
Epoch 11/116
 - 334s - loss: 0.1487 - binary_crossentropy: 0.0868 - acc: 0.9691 - val_loss: 0.8189 - val_binary_crossentropy: 0.8189 - val_acc: 0.8244
/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gradients_impl.py:109: UserWarning: Converting sparse IndexedSlices to a dense Tensor with 123584000 elements. This may consume a large amount of memory.
  num_elements)
